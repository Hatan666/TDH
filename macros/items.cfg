#textdomain wesnoth-TDH

#define ICEPOTION X Y ID
    [item]
        x={X}
        y={Y}
        image=items/potion-blue.png
    [/item]
    [event]
        name=moveto
        first_time_only=no
        [filter]
            side=1
            x={X}
            y={Y}
            [not]
                # We do not want units to get the bonus twice.
                [filter_wml]
                    [attack]
                        range=melee
                        type=cold
                    [/attack]
                [/filter_wml]
            [/not]
        [/filter]
        [object]
            id={ID}
            name= _ "Ice Potion"
            image=items/potion-blue.png
            duration=forever
            description= _ "This potion contains a strange fluid designed to imbue a weapon with the power of cold."
            cannot_use_message= _ "Only a skeletal warrior may acquire this dreaded power!"
            [filter]
                type=Skeleton,Deathblade,Revenant,Draug
                x={X}
                y={Y}
            [/filter]
            [then]
                [remove_item]
                    x={X}
                    y={Y}
                [/remove_item]
            [/then]
            [effect]
                apply_to=attack
                range=melee
                set_type=cold
                increase_damage=50%
            [/effect]
        [/object]
    [/event]
#enddef

#define TREASURE_CHEST X Y MSG_CODE GOLD_AMOUNT
    [item]
        image=items/chest-plain-closed.png
        x={X}
        y={Y}
    [/item]
    [event]
        name=moveto
        [filter]
            x={X}
            y={Y}
            side=1
        [/filter]

        [sound]
            name=open-chest.wav
        [/sound]

        [remove_item]
            x,y={X},{Y}
        [/remove_item]

        [item]
            x,y={X},{Y}
            image=items/chest-plain-open.png
        [/item]

        [redraw][/redraw]

        [message]
            speaker=unit
            message={MSG_CODE}
        [/message]

        [gold]
            side=1
            amount={GOLD_AMOUNT}
        [/gold]

        {VARIABLE gold_amount ({GOLD_AMOUNT})}

        [if]
            [variable]
                name=gold_amount
                greater_than=0
            [/variable]
            [then]
                [sound]
                    name=gold.ogg
                [/sound]
                [floating_text]
                    x={X}
                    y={Y}
                    text= _ "+$gold_amount| gold"
                [/floating_text]
            [/then]
            [elseif]
                [variable]
                    name=gold_amount
                    less_than=0
                [/variable]
                [floating_text]
                    x={X}
                    y={Y}
                    text= _ "-$gold_amount| gold"
                [/floating_text]
            [/elseif]
        [/if]

        {CLEAR_VARIABLE gold_amount}
    [/event]
#enddef
